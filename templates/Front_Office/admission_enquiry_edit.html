{% extends 'base.html' %}


{% block body_block %}
{% load static %}


    <div class="row">
        <div class="main-header">
           <h4>Edit Admission Enquiry</h4>
        </div>
     </div>
     <!-- modal Start -->
     {% if 'admission_enquiry_add' in request.permissions or request.user.is_superuser %}
     <div class="col" style="padding: 30px;">
<button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg" style="float:right;">Edit</button><br>
</div>
<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Admission Enquiry</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
            {% if not view %}
            <h4>Edit Admission Enquiry</h4>
            {% else %}
            <h4>View Admission Enquiry</h4>
            {% endif %}
        <div class="modal-body">
            <form method="post">
              {% csrf_token %}
          <div class="row">
            {% for data in form %}
            <div class="col-md-4 mb-3">
                {{data.label_tag}}
              {{ data }}
            </div>
            {% endfor %}
          </div>
          <br>
          <center>
            {% if not view %}
          <button type="submit" class="btn btn-primary">Submit</button>
          {% endif %}
        </center>
        </form>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
  
     <!-- modal End -->


     {% if 'admission_enquiry_view' in request.permissions or request.user.is_superuser %}
     <div class="col-md-12">
         <div class="card" style="padding: 10px;">
            <div class="table-responsive">
            <table id="tableID" class="display"  >
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Source</th>
                        <th>Enquiry Date</th>
                        <th>Last Follow Up Date</th>
                        <th>Next Follow Up Date</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                      {% for data in records %}   
                      <tr>
                          <td>{{data.name}}</td>
                          <td>{{data.phone_number}}</td>
                          <td>{{data.source}}</td>
                          <td>{{data.date}}</td>
                          <td>{{data.phone_number}}</td>
                          <td>{{data.phone_number}}</td>
                          <td>{{data.phone_number}}</td>
                          <td>
                            {% if 'complain_add' in request.permissions or request.user.is_superuser %}
                            <a href="{% url 'admission_enquiry_view' data.id %}" class="bozero"><span data-toggle="tooltip" title="view" style="color: black;"  ><i class='fa fa-server'></i></a>
                              {% endif %}
                              {% if 'admission_enquiry_edit' in request.permissions or request.user.is_superuser %}
                            <a href="{% url 'admission_enquiry_edit' data.id %}" class="bozero"><span data-toggle="tooltip" title="edit" style="color: black;"><i class='fa fa-edit'></i></a>
                              {% endif %}
                              {% if 'admission_enquiry_delete' in request.permissions or request.user.is_superuser %}
                            <a href="{% url 'admission_enquiry_delete' data.id %}" class="bozero"><span data-toggle="tooltip" title="delete"  style="color: black;"><i class='fa fa-remove' onclick="alert('You want to Delete this Item..?')"></i></a>
                              {% endif %}
                             </td>
                    </tr>
                    {% endfor %}
                  
                </tbody>
        
            </table>
            </div>
         </div>
     </div>
     {% endif %}
 </div>
     <!-- modal Start -->

        <div class="modal fade edit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Edit Admission Enquiry</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
               
                <div class="modal-body">
                    <form>
                  <div class="row">
                    {% for data in form %}
                    <div class="col-md-4 mb-3">
                        {{data.label_tag}}
                      {{ data }}
                    </div>
                    {% endfor %}
                  </div>
                  <br>
                  <center>
                  <button type="button" class="btn btn-primary">Submit</button>
                </center>
                </form>
                </div>
              </div>
            </div>
          </div>
          
             <!-- modal End -->

 {% endblock %}
 {% block script_block %}

 <script>
  $(document).ready(function () {
    // Open the modal when the page is loaded
    $('.bd-example-modal-lg').modal('show');

  });
</script>



<script>
  // Get the modal element and close button
  const modal = document.getElementById("myModal");
  const closeButton = modal.querySelector(".close");

  // Add event listener to close button
  closeButton.addEventListener("click", function () {
    closeModalAndRedirect();
  });

  // Add event listener to modal overlay
  modal.addEventListener("click", function (event) {
    if (event.target === modal) {
      closeModalAndRedirect();
    }
  });

  // Function to close the modal and perform the redirection
  function closeModalAndRedirect() {
    modal.style.display = "none"; // Hide the modal

    // Perform the redirection
    window.location.href = "/admission_enquiry"; // R
  }
</script>

 {% endblock  %}