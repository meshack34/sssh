{% extends 'base.html' %}

{% block body_block %}
{% load static %}
<div class="row">
  <div class="main-header">
    <h4>Edit Homework</h4>
  </div>
</div>
<!-- modal Start -->
<div class="col" style="padding: 30px;">
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg"
    style="float:right;">Edit</button><br>
</div>
<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Homework</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% if not view %}
      <h4>Edit Homework List </h4>
      {% else %}
      <h4>View Homework List</h4>
      {% endif %}
      <div class="modal-body">
        <form method="post">
          {% csrf_token %}
          <div class="row">
            {% for data in form %}
            <div class="col-md-4 mb-3">
              {{data.label_tag}}
              {{ data }}
            </div>
            {% endfor %}
          </div>
          <br>
         
        </form>
      </div>
    </div>
  </div>
</div>

<!-- modal End -->



<div class="col-md-12">
  <div class="card" style="padding: 10px;">
    <div class="table-responsive">
      <table id="tableID" class="display">
        <thead>
          <tr>
            <th>Class</th>
            <th>Section</th>
            <th>Subject Group</th>
            <th>Subject</th>
            <th>Homework Date</th>
            <th>Submission Date</th>
            <th>Evaluation Date</th>
            <th>Created By</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for data in records %}
          <tr>
            <td>{{data.Class}}</td>
            <td>{{data.section}}</td>
            <td>{{data.subject_group}}</td>
            <td>{{data.subject}}</td>
            <td>{{data.homework_date}}</td>
            <td>{{data.submission_date}}</td>
            <td></td>
            <td>Admin</td>
            <td>
              <a href="{% url 'add_homework_view' data.id %}" style="color: black;"><i class='fa fa-server'></i></a>
              <a href="{% url 'add_homework_edit' data.id  %}" style="color: black;"><i class='fa fa-edit'></i></a>
              <a href="{% url 'add_homework_delete' data.id  %}" style="color: black;"><i class='fa fa-remove'
                  onclick="alert('You want to Delete this Item..?')"></i></a>
            </td>
          </tr>
          {% endfor %}

        </tbody>

      </table>
    </div>
  </div>
</div>
</div>
<!-- modal Start -->

<div class="modal fade edit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Admission Enquiry</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <form>
          <div class="row">
            {% for data in form %}
            <div class="col-md-4 mb-3">
              {{data.label_tag}}
              {{ data }}
            </div>
            {% endfor %}
          </div>
          <br>
      
        </form>
      </div>
    </div>
  </div>
</div>
<!-- modal End -->

<!-- modal Start View -->

<div class="modal fade View" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Evaluate Homework</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="card">
          <form method="post">
            {% csrf_token %}
          <div class="row">
              <div class="col-md-6" style="background-color: #f4f4f4;">
                <ul>
                  {% for data in recordss %}
                  <li style="padding-left: 30px; background-color: white;">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="student_ids" value="{{data.id}}" id="heck_{{forloop.counter}}" {% if data.status == 'Submittted' %}checked{% endif %}>
                      <label class="form-check-label" for="heck_{{forloop.counter}}">
                        {{data.student.first_name}}
                      </label>
                    </div>
                  </li>
                  {% endfor %}
                </ul>
              </div>
              <div class="col-md-6" style="background-color: rgb(240, 241, 241);">
                <div class="main-header">
                  <h4>Summary </h4>
                  <hr>
                </div>
                <h6><i class='fa fa-upload'></i>Homework Date:{{record.homework_date}}</h6>
                <h6><i class='fa fa-upload'></i>Submission Date: {{record.submission_date}}</h6>
                <h6><i class='fa fa-upload'></i>Evaluation Date: {% if record.submission_date %}{{record.submission_date}}{% endif %}</h6><br>
                <h6>Created By: Super Admin</h6>
                <h6>Evaluated By: Super Admin</h6>
                <p>Class: {{record.Class}}</p>
                <p>Section: {{record.section}}</p>
                <p>Subject: {{record.subject}}</p>
                <p>Description: {{record.description}}</p>
                <br>
              </div>
              </div>
              <div class="row">
              <div class="col-md-6">
                <label for="">Evaluation Date</label>
                <input type="date" class="form-control" name="evaluation_date" value="{{record.submission_date}}" required>
              </div>
           
          </div>
        </form>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
{% block script_block %}

<script>
  $(document).ready(function () {
    // Open the modal when the page is loaded
    $('.View').modal('show');

  });
</script>
<script>
  // Get the modal element and close button
  const modal = document.getElementById("myModal");
  const closeButton = modal.querySelector(".close");

  // Add event listener to close button
  closeButton.addEventListener("click", function () {
    closeModalAndRedirect();
  });

  // Add event listener to modal overlay
  modal.addEventListener("click", function (event) {
    if (event.target === modal) {
      closeModalAndRedirect();
    }
  });

  // Function to close the modal and perform the redirection
  function closeModalAndRedirect() {
    modal.style.display = "none"; // Hide the modal

    // Perform the redirection
    window.location.href = "{% url 'add_homework' %}"; // Replace with your desired URL
  }
</script>

{% endblock %}