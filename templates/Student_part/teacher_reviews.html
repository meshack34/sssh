{% extends 'student_base.html' %}


{% block body_block %}
{% load static %}
{% load custom_filters %}
<style>
  .gold {
    color: gold;
  }
  .star {
    font-size: 24px;
  }
</style>
<style>
  .ratingg {
      unicode-bidi: bidi-override;
      direction: rtl;
      text-align: center;
  }
  .ratingg > span {
      color: #FFD700;
  }

</style>


<div class="container-fluid">
    <div class="row">
        <div class="main-header">
            <h4>Teachers Reviews</h4>
        </div>
    </div>
<div class="col-md-12">
   
        
        <div class="card" style="padding: 10px;border-top: 5px solid black;" >
            <div class="table-responsive">

            <table id="tableID" class="display">
                <thead>
                    <tr>
                        <th>Teacher Name</th>
                        <th>Subject </th>
                        <th>Time</th>
                        <th>Room Number</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Rating</th>
                        <th>Rate</th>
                    </tr>
                </thead>
                <tbody>
                  {% for data in records %}
                    <tr>
                        <td>{{data.first_name}}</td>  
                        <td>{{data.department}}</td>
                        <td>{{data.first_name}}</td>
                        <td>{{data.first_name}}</td>
                        <td>{{data.email}}</td>
                        <td>{{data.phone_no}}</td>
                        {% if data.id in rating_staff %}
                        {% for rat in rating %}
                        {% if data.id == rat.staff.id %}
                        <td>
                          <div class="ratingg" data-stars="{{rat.rating}}"></div>
                        </td>
                        <td></td>
                        {% endif %}
                        {% endfor %}
                        {% else %}
                        <td></td>
                        <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" onclick="model('{{data.id}}')">
                          +
                        </button></td>
                        {% endif %}

                  
                        
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>


</div>


  </div>
  

  <!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Teacher Ratings</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <label>Teacher Ratings</label>
        <div class="rating-container">
          <span class="star" data-rating="1">☆</span>
          <span class="star" data-rating="2">☆</span>
          <span class="star" data-rating="3">☆</span>
          <span class="star" data-rating="4">☆</span>
          <span class="star" data-rating="5">☆</span>
        </div>

        <form method="post" id="form_id">
          {% csrf_token %}
          <input type="hidden" name="rating" id="ratting">
          <input type="hidden" name="teacher_id" id="teacher_id">
          <label for="">Comment</label><span class="text-danger">*</span><br>
          <textarea name="comment" id="" cols="30" rows="10" style="width: 100%;" class="form-control"></textarea>
        </form>
        
      </div>
      
      
      <div class="modal-footer">
        <button type="submit" id="save-rating" class="btn btn-primary" form="form_id">Save</button>
      </div>
    </div>
  </div>
</div>
  <!-- modal End -->

{% endblock %}
{% block script_block %}





<!-- Star Rating-->



<script>
  const stars = document.querySelectorAll('.star');
  const displayRating = document.getElementById('display-rating');

  let selectedRating = 0;

  stars.forEach(star => {
    star.addEventListener('click', () => {
      const rating = parseInt(star.getAttribute('data-rating'));
      selectedRating = rating;

      // Update star ratings
      stars.forEach(star => {
        const starRating = parseInt(star.getAttribute('data-rating'));
        if (starRating <= rating) {
          star.innerHTML = '★';
          star.classList.add('gold');
        } else {
          star.innerHTML = '☆';
          star.classList.remove('gold');
        }
      });

      // Update display rating
      const ratingStars = '★'.repeat(selectedRating) + '☆'.repeat(5 - selectedRating + 1);
     
      $('#ratting').val(selectedRating);
    });
  });
</script>



<script>
    function amt_validation() {
      var book_id = $('#book').val();
      var url = "{% url 'book_qty_js' %}";
      $.ajax({
        url: url,
        data: {
          'book_id': book_id
        },
        success: function (data) {
          $('#ava_quantity').text('Available Quantity : '+data);
        },
        error: function (data) {
          console.log(data);
        }
      });
    }
  </script>


  
<script>
    $(document).ready(function () {
  
      $(document).on('click', '#dropdownMenuButton', function () {
        var dumy = this;
        var iss_id = $(dumy).closest('tr').find('#iss_id').val();
        var book_id = $(dumy).closest('tr').find('#book_id').val();
        $('#model_iss_id').val(iss_id);
        $('#model_book_id').val(book_id);

      });

    });
  
  </script>
  <script>
    function model(id){
      $('#teacher_id').val(id);
    }
  </script>
<!--  star view  -->
  <script>
    window.onload = function() {
        var ratingContainers = document.querySelectorAll('.ratingg');
        ratingContainers.forEach(function(container) {
            var starCount = parseInt(container.dataset.stars, 10);
            displayRatingg(starCount, container);
        });
    };
  
    function displayRatingg(starCount, container) {
        container.innerHTML = "";
  
        for (var i = 0; i < starCount; i++) {
            var star = document.createElement("span");
            star.innerHTML = "★";
            container.appendChild(star);
        }
    }
  </script>
{% endblock %}