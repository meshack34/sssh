{% extends 'base.html' %}
{% block head_block %}

{% endblock %}

{% block body_block %}
{% load static %}

<div class="container-fluid">
  <div class="row">

    <div class="main-header">
      <div class="col-md-4">
        <h4>Student History</h4>
      </div>
    </div>
  </div>

  <div class="col-md-12">
    <div class="card" style="padding: 10px;">
      <div class="container-fluid" style="padding: 10px;">
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_information_report' %}">Student Report</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'guardian_report' %}">Guardian Report</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_history_report' %}">Student History</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_login_credentials' %}">Student Login Credentials</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'class_subject_report' %}">Class Subject Report</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'admission_report' %}">Admission Report</a>
        </div>
        {% comment %} <div class="col-md-4  mb-3">
          <a href="{% url 'sibling_report' %}">Sibling Report</a>
        </div> {% endcomment %}
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_profile_report' %}" class="text-primary">Student Profile</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'homework_evaluation_report' %}" >Homework Evaluation Report</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_gender_ratio_report' %}">Student Gender Ratio Report</a>
        </div>
        <div class="col-md-4  mb-3">
          <a href="{% url 'student_teacher_ratio_report' %}">Student Teacher Ratio Report</a>
        </div>

      </div>
      <hr>
      <div class="container-fluid">
        <div class="row">
          <form method="post">
            {% csrf_token %}
            <div class="row">
              <div class="col-md-3 mb-3">
                <label for="enquiry">From Date</label>
                <input type="date" class="form-control" name="from_date" required>
              </div>
              <div class="col-md-3 mb-3">
                <label for="enquiry">To Date</label>
                <input type="date" class="form-control" name="to_date" required>
              </div>
              
                <div class="col-md-3 mb-3">
                  <label for="class">Class</label>
                  
                  <select class="form-control" name="class" id="id_class" required>
                      <option value="" >---Select---</option>
                      {% for data in class_records %}
                      <option value="{{ data.id }}">{{data.Class}}</option>
                      {% endfor %}
  
                  </select>
              </div>
              <div class="col-md-3 mb-3">
                <label for="section">Section</label>
                <select class="form-control" name="section" id="id_section" required>
                  <option value="">---Select---</option>
                </select>
              </div>
            </div>
            <div class="col-md-12 mb-3"><br>
              <button type="submit" class="btn btn-primary" style="float: right;">Search</button>
            </div>
          </form>
        </div>  
      </div>
    </div>
  </div>
</div>



{% if records %}
<div class="col-md-12">
  <div class="card" style="padding: 10px;">
    <div class="table-responsive">
      <table id="tableID" class="display">
        <thead>
          <tr>
            <th>Admission No</th>
            <th>Roll Number</th>
            <th>Class</th>
            <th>Section Name</th>
            <th>First Name</th>
            <th>Gender</th>
            <th>Date of Birth</th>
            <th>Category</th>
            <th>Religion</th>
            <th>Caste</th>
            <th>Mobile Number</th>
            <th>Email</th>
            <th>Admission Date</th>
            <th>Blood Group</th>
            <th>Student House</th>
            <th>Height</th>
            <th>Weight</th>
            <th>As on Date</th>
            <th>Fees Discount</th>
            <th>Father Name</th>
            <th>Father Phone</th>
            <th>Father Occupation</th>
            <th>Mother Name</th>
            <th>Mother Phone</th>
            <th>Mother Occupation</th>
            <th>If Guardian Is</th>
            <th>Guardian Name</th>
            <th>Guardian Relation</th>           
            <th>Guardian Phone</th>
            <th>Guardian Occupation</th>
            <th>Guardian Email</th>
            <th>Guardian Address</th>
            <th>Current Address</th>
            <th>Permanent Address</th>
            <th>Route List</th>
            <th>Hostel Details</th>
            <th>Room Number</th>
            <th>Bank Account  Number</th>
            <th>Bank Name</th>
            <th>IFSC Code</th>
            <th>National Identification Number</th>
            <th>Local Identification Number</th>
            <th>RTE</th>
            <th>Previous School Details</th>
            <th>Note</th>
          </tr>
        </thead>
        <tbody>
          {% for data in records %}
          <tr>
            <td>{{data.admission_no}}</td>
            <td>{{data.roll_number}}</td>
            <td>{{data.Class}}</td>
            <td>{{data.section}}</td>
            <td>{{data.first_name}}</td>
            <td>{{data.gender}}</td>
            <td>{{data.date_of_birth}}</td>
            <td>{{data.category}}</td>
            <td>{{data.religion}}</td>
            <td>{{data.Caste}}</td>
            <td>{{data.mobile_number}}</td>
            <td>{{data.email}}</td>
            <td>{{data.admission_date}}</td>
            <td>{{data.Blood_group}}</td>
            <td>{{data.student_house}}</td>
            <td>{{data.height}}</td>
            <td>{{data.weight}}</td>
            <td>{{data.as_on_date}}</td>
            <td></td>
            <td>{{data.Father_name}}</td>
            <td>{{data.Father_phone}}</td>
            <td>{{data.mother_name}}</td>
            <td>{{data.mother_phone}}</td>
            <td>{{data.mother_occupation}}</td>
            <td>{{data.if_guardian_is}}</td>
            <td>{{data.guardian_name}}</td>
            <td>{{data.guardian_relation}}</td>
            <td>{{data.guardian_phone}}</td>
            <td>{{data.guardian_occupation}}</td>
            <td>{{data.guardian_email}}</td>
            <td>{{data.guardian_address}}</td>
            <td>{{data.current_address}}</td>
            <td>{{data.permanent_address}}</td>
            <td>{{data.route_list}}</td>
            <td>{{data.hostel}}</td>
            <td>{{data.room_number}}</td>
            <td>{{data.bank_account_number}}</td>
            <td>{{data.bank_name}}</td>
            <td>{{data.ifsc_code}}</td>
            <td>{{data.national_identification_number}}</td>
            <td>{{data.local_identification_number}}</td>
            <td>{{data.rte}}</td>
            <td>{{data.previous_school_detail}}</td>
            <td>{{data.note}}</td>
           


          </tr>
          {% endfor %}

        </tbody>

      </table>

    </div>



  </div>
  {% else %}
  <center>
    <h5>No Records Found </h5>
  </center>
  {% endif %}
</div>

<!-- modal Start -->

<div class="modal fade edit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Admission Enquiry</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">
            {% for data in form %}
            <div class="col-md-4 mb-3">
              {{data.label_tag}}
              {{ data }}
            </div>
            {% endfor %}
          </div>
          <br>
          <center>
            <button type="button" class="btn btn-primary">Submit</button>
          </center>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- modal End -->

{% endblock %}
{% block script_block %}

<script>
  $(document).ready(function () {
    $(document).on('change', '#id_class', function () {
      var class_id = $('#id_class').val();
      var url = "{% url 'section_js' %}";

      $.ajax({
        url: url,
        data: {
          'class_id': class_id
        },
        success: function (data) {
          $("#id_section").html(data);
          let html_data = '<option value="">--------</option>';
          data.forEach(function (section) {
            html_data += `<option value="${section.id}">${section.section_name}</option>`
          });
          console.log(html_data);
          $("#id_section").html(html_data);
        },
        error: function (data) {
          console.log(data);
        }
      });
    });

  });  
</script>
{% endblock %}