{% extends 'base.html' %}
{% block head_block %}

{% endblock  %}

{% block body_block %}
{% load static %}

<div class="container-fluid">
    <div class="row">

       <div class="main-header">
        <div class="col-md-4">
          <h4>Guardian Report</h4>
          </div>
       </div>
    </div>
  
    <div class="col-md-12">
        <div class="card" style="padding: 10px;">
          <div class="container-fluid" style="padding: 10px;">
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_information_report' %}" >Student Report</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'guardian_report' %} " class="text-primary">Guardian Report</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_history_report' %}" >Student History</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_login_credentials' %}">Student Login Credentials</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'class_subject_report' %}">Class Subject Report</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'admission_report' %}">Admission Report</a>
            </div>
            {% comment %} <div class="col-md-4  mb-3">
              <a href="{% url 'sibling_report' %}" >Sibling Report</a>
            </div> {% endcomment %}
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_profile_report' %}">Student Profile</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'homework_evaluation_report' %}" >Homework Evaluation Report</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_gender_ratio_report' %}">Student Gender Ratio Report</a>
            </div>
            <div class="col-md-4  mb-3">
              <a href="{% url 'student_teacher_ratio_report' %}">Student Teacher Ratio Report</a>
            </div>
            
          </div>
          <hr>
          <form method="post" >
            {% csrf_token %}
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="class">Class</label>
                <select class="form-control" name="class" id="id_class">
                    <option value="" >---Select---</option>
                    {% for data in class_records %}
                    <option value="{{ data.id }}">{{data.Class}}</option>
                    {% endfor %}

                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label for="section">Section</label>
                <select class="form-control" name="section" id="id_section">
                    <option value="">---Select---</option>
              
                </select>                
            </div>
          
      <div class="col-md-12 mb-3"><br>

           <button type="submit" class="btn btn-primary" style="float: right;">Submit</button>
           </div>
              </form>
            </div>
        </div>
    </div>
   


   {% if records %}
     <div class="col-md-12">
         <div class="card" style="padding: 10px;">
          <div class="table-responsive">
            <table id="tableID" class="display"  >
                <thead>
                    <tr>
                        <th>Class (Section)</th>
                        <th>Admission No</th>
                        <th>Student Name</th>
                        <th>Mobile Number</th>
                        <th>Guardian Name</th>
                        <th>Guardian Relation</th>
                        <th>Guardian Phone</th>
                        <th>Father Name</th>
                        <th>Father Phone</th>
                        <th>Mother Name</th>
                        <th>Mother Phone</th>
                    </tr>
                </thead>
                <tbody>
                    {% for data in records %}
                    <tr>
                      <td>{{data.Class}}({{data.section}})</td>
                        <td>{{ data.admission_no }}</td>
                        <td>{{ data.first_name }} {{ data.last_name }}</td>
                        <td>{{ data.mobile_number }}</td>
                        <td>{{ data.guardian_name }}</td>
                        <td>{{ data.guardian_relation }}</td>
                        <td>{{ data.guardian_phone }}</td>
                        <td>{{ data.Father_name }}</td>
                        <td>{{ data.Father_phone }}</td>
                        <td>{{ data.mother_name }}</td>
                        <td>{{ data.mother_phone }}</td>
                        
                    </tr>
                    {% endfor %}
                  
                </tbody>
        
            </table>
            
            </div>
         
           
    
    </div>
    {% else %}
       <center> <h5>No Records Found </h5></center>
    {% endif %}
    </div>
   
     <!-- modal Start -->

        <div class="modal fade edit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Edit Admission Enquiry</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                    <form>
                  <div class="row">
                    {% for data in form %}
                    <div class="col-md-4 mb-3">
                        {{data.label_tag}}
                      {{ data }}
                    </div>
                    {% endfor %}
                  </div>
                  <br>
                  <center>
                  <button type="button" class="btn btn-primary">Submit</button>
                </center>
                </form>
                </div>
              </div>
            </div>
          </div>
          
             <!-- modal End -->

 {% endblock %}
 {% block script_block %}
 
<script>
  $(document).ready(function () {
      $(document).on('change', '#id_class', function () {
          var class_id = $('#id_class').val();
          var url = "{% url 'section_js' %}";

          $.ajax({
              url: url,
              data: {
                  'class_id': class_id
              },
              success: function (data) {
                  $("#id_section").html(data);
                  let html_data = '<option value="">--------</option>';
                  data.forEach(function (section) {
                      html_data += `<option value="${section.id}">${section.section_name}</option>`
                  });
                  console.log(html_data);
                  $("#id_section").html(html_data);
              },
              error: function (data) {
                  console.log(data);
              }
          });
      });

  });

  $(document).ready(function () {
      $(document).on('change', '#id_section', function () {
          var section_id = $('#id_section').val();
          var class_id = $('#id_class').val();
          var url = "{% url 'student_report_js' %}";
          $.ajax({
              url: url,
              data: {
                  'class_id': class_id,
                  'section_id': section_id,
              },
              success: function (data) {
                  $("#id_category").html(data);
                  let html_data = '<option value="">--------</option>';
                  data.forEach(function (subject) {
                      html_data += `<option value="${subject.id}">${subject.category}</option>`
                  });
                  console.log(html_data);
                  $("#id_category").html(html_data);
              },
              error: function (data) {
                  console.log(data);
              }
          });
      });

  });


</script>
 {% endblock  %}