{% extends 'base.html' %}
{% block body_block %}
{% load static %}
<style>
  /* General styling */
  body {
            font-family: Arial, sans-serif;
        }
        h1 {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        .checkbox-container {
            max-height: 200px; /* Adjust the maximum height based on your preference */
            overflow-y: auto; /* Enable vertical scrolling when the content overflows */
            border: 1px solid #ccc;
            padding: 10px;
        }
        .checkbox-label {
            display: block;
            margin-bottom: 5px;
            cursor: pointer; /* Add cursor style to indicate clickability */
        }

        /* Input field styling */
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        /* Checkbox styling */
        input[type="checkbox"] {
            margin-right: 5px;
            display: none;
        }

        /* Hide checkboxes and show them when labels are clicked */
        .checkbox-label input[type="checkbox"] {
            display: inline;
        }
</style>
<div class="container-fluid">
    <div class="row">
        <div class="main-header">
           <h4>Edit Staff Meeting</h4>
        </div>
     </div>
    <div class="col-md-12">
        <div class="row">
            {% if 'staff_meeting_add' in request.permissions or request.user.is_superuser %}   

            <div class="col-md-4">
                <div class="card" style="padding: 10px;border-top: 5px solid black;">
                    <div class="main-header">                       
                     </div><hr>
                     {% if not view %}
                        <h4>Edit Staff Meeting</h4>
                        {% else %}
                        <h4>View Staff Meeting</h4>
                        {% endif %}
                        <form method="post">
                          {% csrf_token %}
            
                          <label for="meeting_title">Meeting Title:</label>
                          <input type="text" id="meeting_title" name="meeting_title" class="form-control" value="{{data.meeting_title}}" required>
                          <br>
                  
                          <label for="meeting_date_time">Date and Time:</label>
                          <input type="datetime-local" id="meeting_date_time" class="form-control" name="meeting_date_time" value="{{ data.meeting_date_time|date:'Y-m-d\TH:i' }}" required>
                          <br>
                  
                          <label for="meeting_duration">Meeting Duration (in minutes):</label>
                          <input type="number" id="meeting_duration" class="form-control" name="meeting_duration" value="{{data.meeting_duration}}" required>
                          <br>
                           <!-- Add the search field -->
                  <label for="search_staff">Search and Select Staff:</label>
                  <input type="text" id="search_staff" onkeyup="filterStaff()" placeholder="Search...">
                  <br>
          
                  <label>Staff:</label>
                  <br>
                  <!-- Use div to group the checkboxes -->
                  <div id="staff_checkboxes">
                      {% for staff in addstaff %}
                      <label class="checkbox-label" onclick="toggleCheckbox(this)">
                          <input type="checkbox" id="staff_{{ staff.id }}" name="staff"  value="{{ staff.id }}" {% if staff in data.staff.all %}checked{% endif %}>
                          {{ staff.first_name }} ({{ staff.roles }})
                      </label>
                      {% endfor %}
                  </div>
                  <br>
                  
                          <label for="meeting_url">Meeting URL:</label>
                          <input type="text" id="meeting_url" class="form-control" name="meeting_url" value="{{data.meeting_url}}" required>
                          <br>
                  
                          <label for="description">Description:</label>
                          <textarea id="description" name="description" class="form-control" value="{{data.description}}" rows="4" cols="50"></textarea>
                          <br>
                  
                          <label for="status">Status:</label>
                          <select id="status" name="status" class="form-control" value="{{data.status}}"   {% if status in data.status.all %}selected{% endif %} required>
                              <option value="Awaited" {% if data.status == 'Awaited'  %}selected{% endif %}>Awaited</option>
                              <option value="Cancelled!" {% if data.status == 'Cancelled!' %}selected{% endif %}>Cancelled!</option>
                              <option value="Finished" {% if data.status == 'Finished' %}selected{% endif %}>Finished</option>
                          </select>
                          <br>

                 
                          <button type="submit" class="btn btn-primary" style="float: right;">Save</button><br><br>
                         
                      </form>
                    
                </div>
            </div>
            {% endif %}
              
     <div class="col-md-8">
        <div class="card" style="padding: 10px;">
           <div class="table-responsive">
           <table id="tableID" class="display"  >
               <thead>
                   <tr>
                       <th>Title</th>
                       <th>Description</th>
                       <th>Date Time</th>
                       <th>Meeting Duration (In Minutes)</th>
                       <th>Created By</th>
                       <th>Status</th>
                       <th>Action</th>
                   </tr>
               </thead>
               <tbody>
                   {% for data in records %}
                     <tr>
                         <td>{{data.meeting_title}}</td>
                         <td>{{data.description}}</td>
                         <td>{{data.meeting_date_time}}</td>
                         <td>{{data.meeting_duration}}</td>
                         <td>{{data.created_by}}</td>
                         <td >
                          <span class="label label-{% if data.status == 'Finished' %}success{% elif data.status == 'Awaited' %}warning{% elif data.status == 'Cancelled!' %}danger{% endif %}">{{ data.status }}</span>
                       </td>
                                               
                       <td>
                        <a href="{{data.meeting_url}}"  class="bozero"><span data-toggle="tooltip" title="Meeting"style="color:white;" target="_blank" class="btn btn-success btn-sm " ><i class='fa fa-video'></i>Start</a>
                          {% if 'staff_meeting_edit' in request.permissions or request.user.is_superuser %}   
                        <a href="{% url 'staff_meeting_edit' data.id %}"  class="bozero"><span data-toggle="tooltip" title="edit"style="color: black;"><i class='fa fa-edit'></i></a>
                          {% endif %}
                          {% if 'staff_meeting_delete' in request.permissions or request.user.is_superuser %}   
                        <a href="{% url 'staff_meeting_delete' data.id %}"  class="bozero"><span data-toggle="tooltip" title="delete"style="color: black;"><i class='fa fa-remove' onclick="alert('You want to Delete this Item..?')"></i></a>
                          {% endif %}
                          {% if 'staff_meeting_view' in request.permissions or request.user.is_superuser %}   
                        <a href="{% url 'staff_meeting_view' data.id  %}"  class="bozero"><span data-toggle="tooltip" title="view"style="color: black;"><i class='fa fa-eye'></i></a>
                       {% endif %}
                          {% if data.status == 'Finished' %}
                        <a href="{% url 'staff_meetimg_backup' data.id  %}" class="bozero"><span data-toggle="tooltip" title="Add Meeting Notes" style="color: black;"><i class='fa fa-plus'></i></a>
                        {% else %}
                        <a href="" ><i class='fa fa-view'  ></i></a>
                        {% endif %}
                         </td>
                   </tr>
                   {% endfor %}
                 
               </tbody>
       
           </table>
           </div>
        </div>
    </div>
          
        </div>
    </div>
    </div>
  
    

 {% endblock %}
 {% block script_block %}
 <script>
  function filterStaff() {
      var input, filter, labels, i, txtValue;
      input = document.getElementById("search_staff");
      filter = input.value.toUpperCase();
      labels = document.getElementsByClassName("checkbox-label");

      for (i = 0; i < labels.length; i++) {
          txtValue = labels[i].textContent || labels[i].innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
              labels[i].style.display = "block";
          } else {
              labels[i].style.display = "none";
          }
      }
  }

  function toggleCheckbox(labelElement) {
      var checkbox = labelElement.querySelector('input[type="checkbox"]');
      checkbox.checked = !checkbox.checked;
  }
</script>
 {% endblock  %}